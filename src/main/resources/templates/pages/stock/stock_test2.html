<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default_layout}">
<head>
    <meta charset="UTF-8">
    <title>ìœ ì‚¬ ì¢…ëª© í…ŒìŠ¤íŠ¸ 1</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div layout:fragment="content">
    <h2>ðŸ“Š ìœ ì‚¬ ì¢…ëª© í…ŒìŠ¤íŠ¸ 1</h2>
    <canvas id="stockChart" width="800" height="400"></canvas>
</div>

<th:block layout:fragment="pageScript">
<script th:inline="javascript">
    let stockData = /*[[${stockData}]]*/ '[]'; 
    if(typeof stockData === 'string') stockData = JSON.parse(stockData);

    const ctx = document.getElementById('stockChart').getContext('2d');
    const labels = stockData.length > 0 ? stockData[0].dates : [];
    const datasets = stockData.map((item, idx) => ({
        label: item.file,
        data: item.prices,
        borderColor: `hsl(${idx * 60}, 70%, 50%)`,
        fill: false
    }));

    new Chart(ctx, { type: 'line', data: { labels, datasets }, options: { responsive: true } });
</script>
</th:block>
</body>
</html>
